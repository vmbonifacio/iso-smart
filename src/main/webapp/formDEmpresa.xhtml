<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/WEB-INF/template.xhtml">

    <ui:define name="title">Datos de Empresa</ui:define>

    <ui:define name="viewname">
        <li>Gestión de Empresa</li>
        <li><i class="pi pi-chevron-right"></i></li>
        <li>
            <p:link outcome="/formDEmpresa">Formulario de Empresa Principal</p:link>
        </li>
    </ui:define>

    <ui:define name="content">
        <h:form> 
            <h5 class="h-5rem text-center text-4xl p-4 text-white-alpha-90" 
                style="background-color: #2A2A2A;
                font-family: 'Inter', sans-serif;
                font-weight: 600;">
                DATOS DE LA EMPRESA
            </h5>

            <div class="col-12 p-3" > 
                <!-- DATOS DE LA EMPRESA PRINCIPAL -->
                <div class="ui-fluid formgrid grid pl-2"
                     style="border-radius: 1rem 1rem 0 0;
                     border-bottom: none;
                     background-color: #F8DA45;
                     box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);">
                    <h5 class="p-3 text-2xl"
                        style="font-family: 'Inter', sans-serif;
                        font-weight: 600;
                        color: black;">
                        DATOS DE LA EMPRESA
                    </h5>  
                </div>

                <div class="ui-fluid formgrid grid"  
                     style="background-color: #EDEDED;
                     margin-bottom: 70px;
                     padding: 30px 140px 30px 140px;
                     box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
                     border-radius: 0 0 1rem 1rem;">

                    <!-- RUC -->
                    <!-- Lado izquierdo: Campos del formulario -->
                    <div class="ui-grid-col-6">
                        <div class="field col-12 md:col-4">
                            <p:outputLabel value="1. RUC"  class="pt-2" style="color: black; font-family: 'Inter', sans-serif; font-weight: 600;" />
                        </div>    
                        <div class="field col-12 md:col-6">    
                            <p:inputText id="ruc" value="#{empresaPManagedBean.selectedEmpresaP.ruc}"
                                                   maxlength="11"
                                                   onkeypress="return /^[0-9]+$/.test(event.key)"
                                                   placeholder="Ingrese el RUC"
                                                   style="background:transparent; color: black; border: none; border-bottom: 3px solid  #f8da45;"/>
                        </div>

                        <!-- RAZON SOCIAL -->

                        <div class="field col-12 md:col-4">
                            <p:outputLabel value="2. Razón Social"  class="pt-2" style="color: black; font-family: 'Inter', sans-serif; font-weight: 600;" />
                        </div>
                        
                        <div class="field col-12 md:col-6">    
                            <p:inputText id="razonsocial" value="#{empresaPManagedBean.selectedEmpresaP.razon_s}" 
                                                   placeholder="Ingrese razón social" 
                                                   style="background:transparent; color: black; border: none; border-bottom: 3px solid  #f8da45;"
                                                   onkeypress="return /^[a-zA-Z\s]+$/.test(event.key);"/> 
                        </div>

                        <!-- NOMBRE COMERCIAL -->

                        <div class="field col-12 md:col-4">
                            <p:outputLabel value="3. Nombre Comercial"  class="pt-2" style="color: black; font-family: 'Inter', sans-serif; font-weight: 600;" />
                        </div>    
                        <div class="field col-12 md:col-6">   
                            <p:inputText id="comercial" value="#{empresaPManagedBean.selectedEmpresaP.nombre_c}" 
                                                   placeholder="Ingrese nombre comercial" 
                                                   style="background:transparent; color: black; border: none; border-bottom: 3px solid  #f8da45;"
                                                   onkeypress="return /^[a-zA-Z\s]+$/.test(event.key);"/> 
                        </div>

                        <!-- ACTIVIDAD ECONOMICA -->

                        <div class="field col-12 md:col-4">
                            <p:outputLabel value="4.  Actividad Económica"  class="pt-2" style="color: black; font-family: 'Inter', sans-serif; font-weight: 600;" />
                        </div>   
                        <div class="field col-12 md:col-6"> 
                            <p:inputText  id="actividad" value="#{empresaPManagedBean.selectedEmpresaP.actividad}" 
                                                    placeholder="Ingrese la actividad económica" 
                                                    style="background:transparent; color: black; border: none; border-bottom: 3px solid  #f8da45;"
                                                    onkeypress="return /^[a-zA-Z\s]+$/.test(event.key);"/> 
                        </div>
                    </div>

                    <!-- Lado derecho: Área para subir imágenes -->
                    <div class="ui-grid-col-6">
                        <div style="border: 1px dashed #cbcbcb; border-radius: 1rem; padding: 20px; text-align: center; position: relative;">
                            <!-- Contenedor de imagen de perfil redonda con líneas trazadas -->
                            <div style="width: 220px; height: 220px; border-radius: 50%; overflow: hidden; display: inline-block; position: relative; border: 3px dashed #cbcbcb;">
                                <!-- Capa de oscurecimiento al pasar el mouse -->
                                <div id="overlay" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.3); opacity: 0; transition: opacity 0.3s;"></div>
                                <img id="profile-image" src="resources/img/placeholder-image-2.png" alt="Imagen de ejemplo" style="max-width: 100%; height: auto; display: block; margin: 0 auto; border-radius: 50%;" onmouseover="darkenImage()" onmouseout="lightenImage()" />
                            </div>
                            <!-- Botón para cargar imagen -->
                            <p:fileUpload mode="advanced"
                                          multiple="false"
                                          sizeLimit="102400" allowTypes="/(\.|\/)(gif|jpe?g|png)$/"
                                          invalidSizeMessage="Maximum file size allowed is 100 KB"
                                          invalidFileMessage="only gif | jpg | jpeg | png is allowed"
                                          label="Subir Imagen"
                                          style="display: block; margin-top: 10px; margin-left: auto; margin-right: auto;"
                                          />
                        </div>
                    </div>

                    <script>
                        function darkenImage() {
                            document.getElementById('overlay').style.opacity = '1';
                        }

                        function lightenImage() {
                            document.getElementById('overlay').style.opacity = '0';
                        }
                    </script>

                    <!-- DOMICILIO -->
                    <div class="ui-fluid formgrid grid p-4 w-full shadow-5" style="background-color: #f8da45; border-radius: 5px; margin: auto;margin-top:10px;margin-bottom:20px;">
                        <div class="field col-12 md:col-4">
                            <p:outputLabel  value="5. Domicilio"  class="pt-2" style="color: black; font-family: 'Inter', sans-serif; font-weight: 600;"/>    
                        </div>

                        <!-- DEPARTAMENTO -->

                        <div class="field col-12 md:col-2">                                
                            <p:outputLabel for="departamento" value="Departamento"  style="color: black; font-family: 'Inter', sans-serif; font-weight: 600;" />
                            <p:selectOneMenu id="departamento" value="#{empresaPManagedBean.empresaP.departamento}" style="background:transparent; border: none; border-bottom: 3px solid black; color: black;">
                                <f:selectItem itemLabel="Seleccione" noSelectionOption="departamentotrue" />
                                <f:selectItems value="#{ubigeo.listaDepartamentos}" var="departamento"
                                               itemValue="#{departamento}" itemLabel="#{departamento}" />
                                <f:ajax listener="#{ubigeo.obtenerListaProvincias(empresaPManagedBean.empresaP.departamento)}" render="provincia distrito" />
                            </p:selectOneMenu>
                        </div>

                        <!-- PROVINCIA -->

                        <div class="field col-12 md:col-2">
                            <p:outputLabel for="provincia" value="Provincia"  style="color: black; font-family: 'Inter', sans-serif; font-weight: 600;" />
                            <p:selectOneMenu id="provincia" value="#{empresaPManagedBean.empresaP.provincia}" style="background:transparent; border: none; border-bottom: 3px solid black; color: black;">
                                <f:selectItem itemLabel="Seleccione" noSelectionOption="true" />
                                <f:selectItems value="#{ubigeo.listaProvincias}" var="provincia"
                                               itemValue="#{provincia}" itemLabel="#{provincia}" />
                                <f:ajax listener="#{ubigeo.obtenerListaDistritos(empresaPManagedBean.empresaP.provincia)}" render="distrito" />
                            </p:selectOneMenu>
                        </div>

                        <!-- DISTRITO -->

                        <div class="field col-12 md:col-2">
                            <p:outputLabel for="distrito" value="Distrito"  style="color: black; font-family: 'Inter', sans-serif; font-weight: 600;" />
                            <p:selectOneMenu id="distrito" value="#{empresaPManagedBean.empresaP.distrito}" style="background:transparent; border: none; border-bottom: 3px solid black; color: black;">
                                <f:selectItem itemLabel="Seleccione" noSelectionOption="true" />
                                <f:selectItems value="#{ubigeo.listaDistritos}" var="distrito"
                                               itemValue="#{distrito}" itemLabel="#{distrito}" />
                            </p:selectOneMenu>
                        </div>

                        <!-- DIRECCION -->

                        <div class="field col-12 md:col-4">
                            <p:outputLabel value=" Direccion"  class="pt-2" style="color: black; font-family: 'Inter', sans-serif; font-weight: 600;" />
                        </div>
                        <div class="field col-12 md:col-6">    
                            <p:inputText id="direccion" value="#{empresaPManagedBean.selectedEmpresaP.direccion}"
                                                   placeholder="Ingrese aquí su dirección" 
                                                   style="background:transparent;border:none; border-bottom:3px solid black; color: black;"
                                                   onkeypress="return /^[a-zA-Z\s]+$/.test(event.key);"/>
                        </div>
                    </div>

                    <!-- TELEFONO -->

                    <div class="field col-12 md:col-4">
                        <p:outputLabel value="6. Telefono"  class="pt-2" style="color: black; font-family: 'Inter', sans-serif; font-weight: 600;" />
                    </div>    
                    <div class="field col-12 md:col-6">    
                        <p:inputText id="telefono"  value="#{empresaPManagedBean.selectedEmpresaP.telefono}" 
                                               placeholder="Ingrese teléfono" 
                                               style="background:transparent; color: black; border: none; border-bottom: 3px solid  #f8da45;"
                                               maxlength="9"
                                               onkeypress="return /^[0-9]+$/.test(event.key)"/> 
                    </div>

                    <!-- CORREO -->

                    <div class="field col-12 md:col-4">
                        <p:outputLabel value="7. Correo"  class="pt-2" style="color: black; font-family: 'Inter', sans-serif; font-weight: 600;" />
                    </div>
                    <div class="field col-12 md:col-6">   
                        <p:inputText id="correo" value="#{empresaPManagedBean.selectedEmpresaP.correo}"  
                                               placeholder="Ingrese correo" 
                                               style="background:transparent; color: black; border: none; border-bottom: 3px solid  #f8da45;"
                                               onkeypress="return /^[a-zA-Z\s]+$/.test(event.key);"/> 
                    </div>

                    <!-- NUMERO DE LICENCIAS -->

                    <div class="field col-12 md:col-4">
                        <p:outputLabel value="8. Núm. de Licencias"  class="pt-2" style="color: black; font-family: 'Inter', sans-serif; font-weight: 600;" />
                    </div>   
                    <div class="field col-12 md:col-6">    
                        <p:inputText id="licencias"  value="#{empresaPManagedBean.selectedEmpresaP.num_licencia}" 
                                               placeholder="Ingrese el número de licencias" 
                                               style="background:transparent; background-color: #EDEDED; color: black; border: none; border-bottom: 3px solid  #f8da45;"
                                               maxlength="4"
                                               onkeypress="return /^[0-9]+$/.test(event.key)"/> 
                    </div>

                    <!-- FECHAS -->

                    <div class="field col-12 md:col-4">
                        <p:outputLabel value="9. Fecha de Fundación"  class="pt-2" style="color: black; font-family: 'Inter', sans-serif; font-weight: 600;" />
                    </div>
                    <div class="field col-12 md:col-6">
                        <p:datePicker id="fundacion" value="#{empresaPManagedBean.selectedEmpresaP.fecha_fundacion}" 
                                                 placeholder="Ingrese fecha de fundación"
                                                 style="background:transparent; background-color: #EDEDED; color: black; border: none; border-bottom: 3px solid  #f8da45;"/> 
                    </div>

                    <!-- FECHA DE OPERACION -->

                    <div class="field col-12 md:col-4">
                        <p:outputLabel value="10. Fecha de Operación"  class="pt-2" style="color: black; font-family: 'Inter', sans-serif; font-weight: 600;" />
                    </div>    
                    <div class="field col-12 md:col-6">   
                        <p:datePicker  id="operacion" value="#{empresaPManagedBean.selectedEmpresaP.fecha_operacion}" 
                                                  placeholder="Ingrese fecha de operación" 
                                                  style="background:transparent; color: black; border: none; border-bottom: 3px solid  #f8da45;"/> 
                    </div>

                    <!-- NUMERO DE SUCURSALES -->

                    <div class="field col-12 md:col-4">
                        <p:outputLabel value="11. Núm. de Sucursales"  class="pt-2" style="color: black; font-family: 'Inter', sans-serif; font-weight: 600;" />
                    </div>    
                    <div class="field col-12 md:col-6">    
                        <p:inputText id="sucursales" value="#{empresaPManagedBean.selectedEmpresaP.numero_s}" 
                                               placeholder="Ingrese el número de sucursales" 
                                               style="background:transparent; color: black; border: none; border-bottom: 3px solid  #f8da45;"
                                               maxlength="4"
                                               onkeypress="return /^[0-9]+$/.test(event.key)"/> 
                    </div>

                    <!-- BOTON PARA AGREGAR LOS REGISTROS -->

                    <div class="field col-12 md:col-3">
                        <p:commandButton oncomplete="mostrarMensaje()"  style="color: black; font-family: 'Inter', sans-serif; font-weight: 600; background-color: #f8da45; height: 70px; border-color: #f8da45; border-radius: 14px; box-shadow: 0px 1px 7px rgba(0, 0, 0, 0.1), 0px 4px 5px -2px rgba(0, 0, 0, 0.12), 0px 10px 15px -5px rgba(0, 0, 0, 0.2) !important;" action="#{empresaPManagedBean.agregarRegistroEmpresaP}" update="@form" value="Guardar Empresa"/>
                    </div>
                </div>
                
                <!-- TABLA DE REGISTROS --> 

                <p:dataTable id="tablaEmpresaP" value="#{empresaPManagedBean.obtenerRegistrosEmpresaP()}" var="emp" rowKey="#{emp.id_empresa_p}" emptyMessage="No se encontraron registros" reflow="true"
                                       rows="4" paginator="true">
                    
                    <!--  CÓDIGO DEL REGISTRO -->
                    
                    <p:column headerText="ID">
                        <h:outputText value="#{emp.id_empresa_p}" />
                    </p:column>

                    <!--  RUC  -->

                    <p:column headerText="RUC">
                        <h:outputText value="#{emp.ruc}" />
                    </p:column>

                    <!--  RAZON SOCIAL  -->

                    <p:column headerText="Razón Social">
                        <h:outputText value="#{emp.razon_s}" />
                    </p:column>

                    <!--  NOMBRE COMERCIAL  -->

                    <p:column headerText="Nombre Comercial">
                        <h:outputText value="#{emp.nombre_c}" />
                    </p:column>

                    <!--  ACTIVIDAD ECONOMICA  -->

                    <p:column headerText="Actividad Económica">
                        <h:outputText value="#{emp.actividad}" />
                    </p:column>

                    <!--  DEPARTAMENTO  -->

                    <p:column headerText="Departamento" style="font-size: 11px;">
                        <h:outputText value="#{emp.departamento}" />
                    </p:column>

                    <!--  PROVINCIA  -->

                    <p:column headerText="Provincia">
                        <h:outputText value="#{emp.provincia}" />
                    </p:column>

                    <!--  DISTRITO  -->

                    <p:column headerText="Distrito">
                        <h:outputText value="#{emp.distrito}" />
                    </p:column>

                    <!--  DIRECCION  -->

                    <p:column headerText="Dirección">
                        <h:outputText value="#{emp.direccion}" />
                    </p:column>

                    <!--  TELEFONO  -->

                    <p:column headerText="Telefono">
                        <h:outputText value="#{emp.telefono}" />
                    </p:column>

                    <!--  CORREO  -->

                    <p:column headerText="Correo">
                        <h:outputText value="#{emp.correo}" />
                    </p:column>

                    <!--  NUMERO DE LICENCIA  -->

                    <p:column headerText="Núm. de Licencias">
                        <h:outputText value="#{emp.num_licencia}" />
                    </p:column>

                    <!--  FECHA DE FUNDACION  -->

                    <p:column headerText="Fecha de Fundación">
                        <h:outputText value="#{emp.fecha_fundacion}" />
                    </p:column>

                    <!--  FECHA DE OPERACION   -->

                    <p:column headerText="Fecha de Operación">
                        <h:outputText value="#{emp.fecha_operacion}" />
                    </p:column>

                    <!--  NUMERO DE SUCURSALES  -->

                    <p:column headerText="Núm. de Sucursales">
                        <h:outputText value="#{emp.numero_s}" />
                    </p:column>

                    <p:column headerText="Acciones">
                        <p:commandButton icon="pi pi-times" 
                                                           styleClass="rounded-button ui-button-danger" 
                                                           action="#{empresaPManagedBean.eliminarRegistroEmp(emp.id_empresa_p)}" 
                                                           update="@form"/>
                    </p:column>
                </p:dataTable> 
            </div>
        </h:form>
    </ui:define>

</ui:composition>
